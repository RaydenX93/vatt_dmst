function f3 = tip_new(mu_z,tsr,ar)
% Tip losses correlation from 3D CFD data

f1 = abs(mu_z);

% Variabili importate da codice.m %%
ar_ref = [0.9 1.35 1.8];

k_tot = reshape([1 1 1 1 1 1 1.0002003465632479 1 1 1.0013005473498913 ...
    1 1 1.0024007481365349 1 1 1.0035009489231785 1 1 1.0046011331756421 ...
    1 1 1.0057013037020739 1 1 1.0068014742285054 1 1 1.0079016447549372 ...
    1 1 1.0092523035453969 1 1 1.0106275545287016 1 1 1.0120028055120058 ...
    1 1 1.0133024451962482 1.0000756112990621 1.0002268338971863 ...
    1.0144026459828916 1.0003506614957229 1.001051984487169 ...
    1.0155028467695353 1.0006257116923838 1.0018771350771516 ...
    1.0166030475561789 1.0009007618890446 1.0027022856671342 ...
    1.0185822652511138 1.0013516145002475 1.0028241927498762 ...
    1.0210576489355849 1.0019016997634631 1.0025491501182682 ...
    1.023533032620056 1.002451785026679 1.0022741074866603 ...
    1.0260023379266716 1.0029995324146657 1.002 1.026689963418324 ...
    1.002862007316335 1.002 1.0273775889099761 1.0027244822180048 ...
    1.002 1.0280652144016282 1.0025869571196742 1.002 1.0287528398932806 ...
    1.002449432021344 1.002 1.0294404653849327 1.0023119069230133 ...
    1.002 1.0301280908765849 1.0021743818246831 1.002 1.030815716368237 ...
    1.0020368567263525 1.002 1.0310671110173919 1.0018657779652158 ...
    1.0016644449130399 1.0311587927351407 1.0016824145297185 ...
    1.0012060363242965 1.0312504744528892 1.0014990510942212 ...
    1.0007476277355531 1.031342156170638 1.0013156876587241 ...
    1.00028921914681 1.0314338378883867 1.0011323242232266 ...
    0.99983081055806666 1.0315255196061353 1.0009489607877293 ...
    0.99937240196932331 1.031617201323884 1.000765597352232 ...
    0.99891399338058 1.0317088830416328 1.0005822339167347 ...
    0.9984555847918366 1.0318005647593813 1.0003988704812374 ...
    0.99799717620309336 1.0318922464771298 1.00021550704574 ...
    0.99753876761435 1.0319839281948786 1.0000321436102426 ...
    0.99708035902560677 1.032150861595873 0.99962284601031715 ...
    0.99632112281857088 1.0323337906559837 0.99916552336004094 ...
    0.99549794204807374 1.032516719716094 0.99870820070976474 ...
    0.99467476127757659 1.0326996487762046 0.99825087805948853 ...
    0.99385158050707934 1.0328825778363151 0.99779355540921233 ...
    0.99302839973658219 1.0330655068964256 0.99733623275893613 ...
    0.99220521896608482 1.0332484359565361 0.99687891010865981 ...
    0.99138203819558768 1.0334313650166467 0.99642158745838361 ...
    0.99055885742509053 1.033614294076757 0.9959642648081074 ...
    0.98973567665459328 1.0337972231368675 0.9955069421578312 ...
    0.98891249588409613 1.033980152196978 0.995049619507555 ...
    0.98808931511359888 1.0338233254062625 0.994116627031312 ...
    0.986674940546968 1.0336251486325803 0.99312574316290125 ...
    0.98518861474435193 1.033426971858898 0.99213485929449063 ...
    0.983702288941736 1.0332287950852161 0.99114397542608 ...
    0.98221596313912007 1.0330306183115341 0.99015309155766951 ...
    0.9807296373365042 1.0328324415378518 0.98916220768925878 ...
    0.97924331153388822 1.0326342647641695 0.98817132382084816 ...
    0.97775698573127223 1.0324360879904875 0.98718043995243754 ...
    0.97627065992865636 1.0322379112168054 0.98618955608402692 ...
    0.97478433412604049 1.0320397344431234 0.9851986722156163 ...
    0.97329800832342439 1.0303728405703407 0.98365998635204543 ...
    0.97089426426749981 1.028337619269954 0.981983921751727 ...
    0.96826044846699955 1.0263023979695673 0.98030785715140845 ...
    0.96562663266649906 1.0242671766691807 0.97863179255109 ...
    0.96299281686599869 1.022231955368794 0.97695572795077168 ...
    0.96035900106549821 1.0201967340684073 0.97527966335045313 ...
    0.95772518526499772 1.0181615127680206 0.97360359875013458 ...
    0.95509136946449735 1.0161262914676339 0.97192753414981625 ...
    0.95245755366399687 1.0141576274629291 0.9695744464757261 ...
    0.94905606337599024 1.0122714372769217 0.9663824323147906 ...
    0.94470331679289632 1.0103852470909143 0.963190418153855 ...
    0.94035057020980228 1.008499056904907 0.95999840399291947 ...
    0.93599782362670847 1.0066128667188996 0.956806389831984 ...
    0.93164507704361466 1.0047266765328922 0.95361437567104845 ...
    0.92729233046052062 1.0028404863468849 0.95042236151011283 ...
    0.92293958387742669 1.0037607763564182 0.94567408910454342 ...
    0.91708716365240406 1.0069367798853111 0.93967497132774591 ...
    0.91002937803264228 1.0101127834142036 0.9336758535509484 ...
    0.9029715924128805 1.0132887869430967 0.92767673577415088 ...
    0.89591380679311872 1.0164647904719895 0.92167761799735337 ...
    0.88885602117335694 1.0196407940008823 0.91567850022055575 ...
    0.881798235553595 1.0177074788902292 0.9054478287092883 ...
    0.87068365500603129 1.0151226089953473 0.89467753748061352 ...
    0.85905174047906263 1.0125377391004653 0.88390724625193862 ...
    0.84741982595209375 1.0099528692055835 0.87313695502326383 ...
    0.83578791142512487 1.0039960380348651 0.8607377179080824 ...
    0.82241481774960368 0.987619915478077 0.84330507131537236 ...
    0.80366151611199155 0.97124379292128893 0.82587242472266242 ...
    0.7849082144743792 0.95486767036450071 0.80843977812995238 ...
    0.76615491283676684 0.93211917705654468 0.78631322634200318 ...
    0.74211917705654462 0.90184475406100439 0.75864305478693961 ...
    0.71184475406100445 0.87157033106546433 0.73097288323187593 ...
    0.68157033106546427 0.834434463276836 0.69699459241323636 ...
    0.644278450363196 0.78641186440677946 0.65300750605326863 ...
    0.59585230024213054 0.73838926553672357 0.60902041969330134 ...
    0.54742615012106577 0.66305853314527563 0.54092383638928121 ...
    0.46885472496473968 0.58498075760628687 0.47040197461213012 ...
    0.38725085633689338 0.45137608571609789 0.34674297850757696 ...
    0.23815488492994447 0.26813029814665706 0.18965245769540784 ...
    0.098792344883159217 0.024949201741654516 0 0 0 0 0 1 ...
    1 1 1 1 1 1 1 1 1 1 1 1.0001666666666666 1 1 1.0005833333333332 ...
    1 1 1.001 1 1 1.0018695652173912 1 1 1.0027391304347826 ...
    1 1 1.0035833333333333 1.0005833333333334 1.000875 1.0044166666666665 ...
    1.0014166666666666 1.002125 1.005 1.002 1.003 1.005 1.002 ...
    1.003 1.005 1.002 1.003 1.005 1.002 1.003 1.005 1.002 ...
    1.003 1.005 1.0020704225352113 1.0029295774647886 1.005 ...
    1.0022112676056338 1.0027887323943661 1.005 1.0023521126760562 ...
    1.0026478873239437 1.005 1.0024929577464787 1.0025070422535212 ...
    1.005 1.0026338028169013 1.0023661971830986 1.005 1.0027746478873238 ...
    1.002225352112676 1.005 1.0029154929577464 1.0020845070422535 ...
    1.0049444444444444 1.0029444444444444 1.0018888888888891 ...
    1.0048055555555555 1.0028055555555555 1.001611111111111 ...
    1.0046666666666666 1.0026666666666666 1.0013333333333334 ...
    1.0045277777777777 1.0025277777777779 1.0010555555555556 ...
    1.0043888888888888 1.002388888888889 1.0007777777777778 ...
    1.0042499999999999 1.00225 1.0005 1.0041111111111112 1.0021111111111112 ...
    1.0002222222222221 1.004 1.0019444444444445 0.99994444444444441 ...
    1.004 1.0016666666666667 0.9996666666666667 1.004 1.0013888888888889 ...
    0.99938888888888888 1.004 1.0011111111111111 0.99911111111111106 ...
    1.004 1.0008333333333335 0.99883333333333335 1.004 1.0005555555555556 ...
    0.99855555555555553 1.004 1.0002777777777778 0.99827777777777782 ...
    1.004 1 0.998 1.004 0.99986111111111109 0.99758333333333327 ...
    1.004 0.99972222222222218 0.99716666666666665 1.004 0.99958333333333327 ...
    0.99675 1.004 0.99944444444444447 0.99633333333333329 ...
    1.004 0.99930555555555556 0.99591666666666667 1.004 0.99916666666666665 ...
    0.9955 1.004 0.99902777777777774 0.99508333333333332 1.004 ...
    0.99878082191780826 0.99445205479452048 1.004 0.99850684931506839 ...
    0.99376712328767114 1.004 0.99823287671232874 0.99308219178082191 ...
    1.004 0.9979589041095891 0.99239726027397257 1.004 0.99768493150684934 ...
    0.99171232876712323 1.004 0.99741095890410958 0.99102739726027389 ...
    1.004 0.99713698630136993 0.99034246575342466 1.004 0.99665753424657544 ...
    0.98945205479452059 1.004 0.995972602739726 0.98835616438356155 ...
    1.004 0.99528767123287687 0.98726027397260285 1.004 0.99460273972602731 ...
    0.98616438356164382 1.004 0.99391780821917808 0.9850684931506849 ...
    1.004 0.99323287671232874 0.983972602739726 1.004 0.9925479452054794 ...
    0.982876712328767 1.004027397260274 0.99180821917808215 ...
    0.98167123287671232 1.0041643835616438 0.99084931506849316 ...
    0.98002739726027388 1.0043013698630137 0.98989041095890407 ...
    0.97838356164383566 1.0044383561643835 0.98893150684931508 ...
    0.97673972602739723 1.0045753424657533 0.98797260273972609 ...
    0.97509589041095879 1.0047123287671234 0.987013698630137 ...
    0.97345205479452046 1.004849315068493 0.986054794520548 ...
    0.97180821917808213 1.004986301369863 0.98509589041095891 ...
    0.97016438356164381 1.0041940298507464 0.98338805970149257 ...
    0.96744776119403 1.0032985074626866 0.981597014925373 ...
    0.96461194029850739 1.0024029850746268 0.97980597014925375 ...
    0.961776119402985 1.001507462686567 0.97801492537313428 ...
    0.95894029850746265 1.0006119402985074 0.97622388059701493 ...
    0.95610447761194028 0.99971641791044774 0.97443283582089557 ...
    0.95326865671641792 0.99882142857142853 0.97235714285714292 ...
    0.95010714285714282 0.99792857142857139 0.96914285714285708 ...
    0.94564285714285712 0.99703571428571447 0.96592857142857147 ...
    0.94117857142857142 0.99614285714285711 0.96271428571428574 ...
    0.93671428571428572 0.99525000000000008 0.95949999999999991 ...
    0.93225 0.99435714285714283 0.95628571428571429 0.92778571428571421 ...
    0.99256521739130421 0.95160869565217387 0.92156521739130437 ...
    0.99017391304347824 0.94595652173913036 0.91417391304347828 ...
    0.98778260869565215 0.94030434782608685 0.90678260869565208 ...
    0.98539130434782618 0.93465217391304356 0.8993913043478261 ...
    0.983 0.929 0.892 0.97786486486486479 0.9184594594594595 ...
    0.8795675675675676 0.97272972972972971 0.907918918918919 ...
    0.86713513513513507 0.96759459459459451 0.89737837837837842 ...
    0.85470270270270265 0.96138709677419354 0.884774193548387 ...
    0.84 0.95267741935483863 0.86735483870967744 0.82 0.94396774193548394 ...
    0.84993548387096762 0.8 0.93207692307692314 0.83046153846153847 ...
    0.77792307692307694 0.90746153846153843 0.80276923076923079 ...
    0.74753846153846149 0.88284615384615384 0.775076923076923 ...
    0.717153846153846 0.8451 0.7373 0.67529999999999979 0.7986000000000002 ...
    0.69280000000000019 0.62580000000000013 0.73905882352941177 ...
    0.63582352941176468 0.56294117647058817 0.67082352941176471 ...
    0.57052941176470584 0.49117647058823527 0.5622307692307692 ...
    0.46846153846153843 0.37530769230769234 0.40116510989400822 ...
    0.31421933104771793 0.19205235302651957 0.11179169702000095 ...
    0.0741510478593363 0.029915015016212926 0 0 0 1 1 1 1 ...
    1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1.0027777777777778 ...
    1.0005555555555556 1 1.0052222222222222 1.001 1.0001111111111112 ...
    1.0063333333333333 1.001 1.0006666666666666 1.0063333333333333 ...
    1.001 1.001 1.0046666666666666 1.001 1.001 1.0043333333333333 ...
    1.001 1.001 1.0048888888888887 1.001 1.001 1.0045471698113206 ...
    1.001 1.0008490566037735 1.0039811320754717 1.001 1.0006603773584906 ...
    1.0034150943396225 1.001 1.0004716981132076 1.0028490566037735 ...
    1.001 1.0002830188679246 1.0022830188679246 1.001 1.0000943396226414 ...
    1.002 1.001 1 1.002 1.001 1 1.002 1.001 1 1.002 1.001 ...
    1 1.002 1.001 1 1.0019814814814816 1.001 0.99998148148148158 ...
    1.0017962962962963 1.001 0.99979629629629629 1.001611111111111 ...
    1.001 0.99961111111111112 1.0014259259259259 1.001 0.99942592592592594 ...
    1.0012407407407407 1.001 0.99924074074074076 1.0010555555555554 ...
    1.001 0.99905555555555559 1.001 1.0008679245283016 0.99873584905660373 ...
    1.001 1.0006792452830187 0.99835849056603765 1.001 1.0004905660377359 ...
    0.99798113207547168 1.001 1.0003018867924527 0.99760377358490571 ...
    1.001 1.0001132075471697 0.99722641509433962 1.0009259259259258 ...
    0.99992592592592588 0.99685185185185188 1.0007407407407407 ...
    0.99974074074074082 0.99648148148148152 1.0005555555555556 ...
    0.99955555555555553 0.99611111111111117 1.0003703703703704 ...
    0.99937037037037035 0.99574074074074082 1.0001851851851851 ...
    0.99918518518518518 0.99537037037037035 1 0.999 0.995 ...
    1 0.998811320754717 0.994433962264151 1 0.99862264150943414 ...
    0.993867924528302 1 0.99843396226415093 0.99330188679245279 ...
    1 0.998245283018868 0.99273584905660373 1 0.998056603773585 ...
    0.99216981132075477 1 0.99774074074074071 0.99161111111111111 ...
    1 0.99737037037037035 0.99105555555555547 1 0.997 0.99049999999999994 ...
    1 0.99662962962962964 0.98994444444444452 1 0.99625925925925918 ...
    0.98938888888888887 0.99994545454545447 0.99594545454545447 ...
    0.98878181818181821 0.99976363636363641 0.99576363636363641 ...
    0.98805454545454552 0.99958181818181813 0.99558181818181812 ...
    0.98732727272727261 0.9994 0.99540000000000006 0.98659999999999992 ...
    0.99921818181818178 0.99521818181818189 0.98587272727272723 ...
    0.99903636363636361 0.99503636363636361 0.98514545454545455 ...
    0.99914814814814812 0.99455555555555553 0.98411111111111116 ...
    0.99933333333333341 0.99400000000000011 0.9830000000000001 ...
    0.99951851851851847 0.99344444444444446 0.98188888888888881 ...
    0.99970370370370376 0.99288888888888893 0.98077777777777775 ...
    0.99988888888888883 0.9923333333333334 0.97966666666666657 ...
    1 0.99163636363636365 0.97834545454545452 1 0.99072727272727268 ...
    0.97670909090909086 1 0.98981818181818193 0.97507272727272731 ...
    1 0.988909090909091 0.97343636363636354 1 0.988 0.9718 ...
    1 0.987090909090909 0.97016363636363634 1 0.98569090909090917 ...
    0.96787272727272722 1 0.98423636363636358 0.96550909090909087 ...
    1 0.9827818181818182 0.96314545454545453 1 0.98132727272727283 ...
    0.96078181818181818 1 0.97987272727272723 0.95841818181818172 ...
    0.99944 0.97796 0.9554 0.99804 0.97536 0.9514 0.99664 ...
    0.97276 0.9474 0.99524 0.97015999999999991 0.9434 0.99384 ...
    0.96756 0.9394 0.991952380952381 0.96409523809523812 0.9344285714285715 ...
    0.9893333333333334 0.95933333333333337 0.928 0.98671428571428577 ...
    0.95457142857142863 0.92157142857142871 0.98409523809523813 ...
    0.94980952380952377 0.91514285714285726 0.98147058823529409 ...
    0.94441176470588228 0.90794117647058825 0.97882352941176465 ...
    0.936470588235294 0.89764705882352935 0.9761764705882352 ...
    0.92852941176470583 0.88735294117647057 0.97352941176470587 ...
    0.9205882352941176 0.87705882352941178 0.96775862068965512 ...
    0.90824137931034488 0.8620344827586206 0.96120689655172409 ...
    0.89479310344827589 0.84582758620689646 0.954655172413793 ...
    0.88134482758620691 0.82962068965517244 0.94304347826086965 ...
    0.85847826086956536 0.80373913043478262 0.93086956521739128 ...
    0.83456521739130429 0.77678260869565219 0.90578947368421048 ...
    0.80226315789473679 0.74105263157894719 0.87210526315789483 ...
    0.7643684210526317 0.69947368421052647 0.81906666666666661 ...
    0.71146666666666669 0.6408 0.75050000000000006 0.64566666666666672 ...
    0.568 0.653 0.554 0.468 0.509 0.418 0.315 0.21466666666666667 ...
    0.15200000000000002 0.061333333333333337 0 0 0], 3, 101, 3);

mu_ref = [0 0.01 0.02 0.03 0.04 0.05 0.06 0.07 0.08 0.09 0.1 0.11 0.12 ...
    0.13 0.14 0.15 0.16 0.17 0.18 0.19 0.2 0.21 0.22 0.23 0.24 0.25 ...
    0.26 0.27 0.28 0.29 0.3 0.31 0.32 0.33 0.34 0.35 0.36 0.37 0.38 ...
    0.39 0.4 0.41 0.42 0.43 0.44 0.45 0.46 0.47 0.48 0.49 0.5 0.51 ...
    0.52 0.53 0.54 0.55 0.56 0.57 0.58 0.59 0.6 0.61 0.62 0.63 0.64 ...
    0.65 0.66 0.67 0.68 0.69 0.7 0.71 0.72 0.73 0.74 0.75 0.76 0.77 ...
    0.78 0.79 0.8 0.81 0.82 0.83 0.84 0.85 0.86 0.87 0.88 0.89 0.9 ...
    0.91 0.92 0.93 0.94 0.95 0.96 0.97 0.98 0.99 1];

tsr_ref = [2.3 2.625 3.1];
% FINE - Variabili importate da codice.m %%

%f3 = interp3(mu_ref,tsr_ref,ar_ref,k_tot,f1,tsr,ar);
f3 = lininterp3(tsr_ref,mu_ref,ar_ref,k_tot,tsr,f1,ar);
end